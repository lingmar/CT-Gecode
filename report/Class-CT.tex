\STATE $\Class$ CT-Propagator
    \item[]
      \STATE $\Scp$: array of variables
      \STATE $\CurrTable$: SparseBitSet \COMMENT{Current supported tuples}
      \STATE $\Supports$: array of BitSet   \COMMENT{$\Supports[x,a]$ is the bit-set of supports for $(x,a)$}
      \STATE $\LastSizes$: array of int \COMMENT{$\LastSizes[x]$ is the last size of the domain of $x$.c}
      \STATE $\Residues$: array of int  \COMMENT{$\Residues[x,a]$ is the last found support for $(x,a)$. 
      No residues yet!}
            
    \item[]
      \Func{updateTable}{}   
      \FOREACH{$x \in \Scp \text{~such that~} |\Dom{x}| \neq \LastSizes[x]$}
        \STATE $\LastSizes[x] \leftarrow |\Dom{x}|$
        \STATE $\CurrTable$.clearMask() 
        \FOREACH{$a \in \Dom{x}$} %\COMMENT{No incremental update yet!}
          \STATE $\CurrTable$.addToMask($\Supports[x,a]$)
          \STATE $\CurrTable$.intersectWithMask()
          \IF{$\CurrTable$.isEmpty()}
            \STATE $\Break$ \COMMENT{No valid tuples left}
          \ENDIF
        \ENDFOREACH
     \ENDFOREACH
     \Endfunc

    \item[]
      \Func{filterDomains}{}
      \STATE $\localvar{count\_unassigned} \leftarrow 0$
      \FOREACH{$x \in \Scp \text{~such that~} |\Dom{x}| > 1$}
            \FOREACH{$a \in \Dom{x}$}
                  \STATE $\texttt{index} \leftarrow \CurrTable$.intersectIndex($\Supports[x,a]$)
                  \IF{$\texttt{index~} \neq -1$}
                        \STATE \todo{save index in residues} \COMMENT{No residues yet!}
                  \ELSE
                        \STATE $\Dom{x} \leftarrow \Dom{x} \setminus \Set{a}$
                        \IF{$|\Dom{x}| > 1$}
                           \STATE $\localvar{count\_unassigned} \leftarrow \localvar{count\_unassigned} + 1$
                        \ENDIF
                  \ENDIF
             \ENDFOREACH
      \ENDFOREACH
      \IF{$\localvar{count\_unassigned} \leq 1$}
        \RETURN{$Subsumed$}
      \ELSE
        \RETURN{$Fixpoint$}
      \ENDIF
      \Endfunc

    \item[]
      \STATE $\Method{propagate}{}$
      \STATE updateTable()
      \IF{$\CurrTable$.isEmpty()}
        \RETURN{$Failed$}
      \ENDIF
      \RETURN{filterDomains()}
